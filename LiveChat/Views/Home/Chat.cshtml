@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "Chat";
    // Enables popover
    //http:// jsfiddle.net/qy9Az/4731/
}
<h2>Chat</h2>

<div class="container">
    <input type="text" id="message" />
    <input type="button" id="sendmessage" value="Send" />
    <ul id="discussion"></ul>
</div>
@section scripts {
    <!--Script references. -->
<!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
<!--Reference the SignalR library. -->
<script src="~/Scripts/jquery.signalR-2.2.3.min.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<!--SignalR script to update the chat page and send messages.-->
<script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call back to display messages.
            //RECEIVE
            chat.client.addNewMessageToPage = function (name, group, message) {
                // Add the message to the page.
                $('#discussion').append('<li><strong>' + htmlEncode(name)
                    + '</strong>: ' + htmlEncode(message) + '</li>');
            };

            // Get the user name and store it to prepend to messages.
            //$('#displayname').val(prompt('Enter your name:', ''));
            //$('#displaygroup').val(prompt('Enter groups names (separated with coma):', ''))
            // Set initial focus to message input box.
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    //SEND
                    chat.server.send($('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });

                //$('#registeruser').click(function () {
                //    // Call the Send method on the hub.
                //    chat.server.register($('#displayname').val(), $('#displaygroup').val());
                //    // Clear text box and reset focus for next comment.
                //    $('#message').focus();
                //});
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
</script>

}



<!--input id='displayname' type='hidden' value='ViewBag.UserName' />
<br><br><br><br><br><br><br><br><br><br><br><br>
<div id="LiveChatWrapper" class="card text-white bg-dark">
    
    <button 
            class="btn btn-lg btn-dark"
            
            data-placement="top"
            data-toggle="popover"
            title='Live chat'  
            
            data-content="<div class='input-group mb-3'><div class='input-group-prepend'><span class='input-group-text' id='basic-addon1'>Group:</span></div><input type='text' id='displaygroup' class='form-control' placeholder='group name' aria-label='group name' aria-describedby='basic-addon2'><div class='input-group-append'><button id='registeruser' class='btn btn-outline-secondary' type='button'>Register</button></div></div><div class='input-group mb-3'><input type='text' id='message' class='form-control' placeholder='type your message...' aria-label='type your message...' aria-describedby='basic-addon2'><div class='input-group-append'><button id='sendmessage' class='btn btn-outline-secondary' type='button'>Send</button></div><ul id='discussion'></ul></div>">


        LiveChat!
    </button>
</div-->

<!--Script references. 
<!--The jQuery library is required and is referenced by default in _Layout.cshtml. 
<!--Reference the SignalR library. 
<script src="~/Scripts/jquery.signalR-2.2.3.min.js"></script>
<!--Reference the autogenerated SignalR hub script. 
<script src="http://testlivechat.azurewebsites.net/signalr/hubs"></script>
<!--SignalR script to update the chat page and send messages.
<script src="~/Scripts/bootstrap.bundle.min.js"></script>
<script src="~/Scripts/LiveChat.js"></script>-->
